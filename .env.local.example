# === Core connections (required) ===
# URL of the external "Brain" service handling text ingestion.
BRAIN_URL=http://192.168.177.151:8080
# API key for the Brain service.
BRAIN_API_KEY=change-me
# Name of the Qdrant collection the Brain service should target.
BRAIN_COLLECTION=documents
# Host URL of the Ollama inference endpoint.
OLLAMA_HOST=http://192.168.177.130:11434
# Model name to use on the Ollama host.
OLLAMA_MODEL=mistral-small3.2:latest
# Optional override to use different model for relevance check; fall back to OLLAMA_MODEL if unset.
OLLAMA_MODEL_RELEVANCE=
# Optional override to use different model for chunking; fall back to OLLAMA_MODEL if unset.
OLLAMA_MODEL_CHUNKING=
# Optional override to use different model for adding context to chunk; fall back to OLLAMA_MODEL if unset.
OLLAMA_MODEL_CONTEXT=
# Web endpoint of the docling-serve converter.
DOCLING_SERVE_URL=http://192.168.177.130:5001/v1/convert/file
# Enable asynchronous docling-serve processing (recommended for large documents).
DOCLING_SERVE_USE_ASYNC=1
# Optional async endpoint override; defaults to the sync URL when unset.
DOCLING_SERVE_ASYNC_URL=

# === Data storage (optional) ===
# Path to the SQLite database file used by scheduler and worker.
DB_PATH=DocumentDatabase/state.db

# === Brain request tuning (optional) ===
# Maximum token length per chunk sent to the Brain service.
BRAIN_CHUNK_TOKENS=400
# Timeout (seconds) for POST /ingest/text requests to the Brain service.
BRAIN_REQUEST_TIMEOUT=120

# === Relevance scoring via Ollama (optional) ===
# Minimum relevance score to store a chunk.
RELEVANCE_THRESHOLD=0.55
# Minimum characters required for a document to be considered.
MIN_CHARS=200
# Hard cap for extracted text length; longer texts will be trimmed.
MAX_TEXT_CHARS=100000
# Maximum Chunk size (characters) passed to the Brain for ingestion (ca.).
MAX_CHARS=4000
# Overlap (characters) between relevance chunks.
OVERLAP=400
# Maximum number of chunks passed to BRain for ingestion.
MAX_CHUNKS=200

# === OCR and PDF handling (optional) ===
# Enable OCR fallback for PDFs (requires tesseract/pytesseract/pdf2image).
ENABLE_OCR=0
# Timeout (seconds) for pdftotext execution.
PDFTOTEXT_TIMEOUT_S=60
# Maximum pages to OCR per PDF (0 = no limit).
PDF_OCR_MAX_PAGES=20
# DPI used when rasterizing PDFs for OCR.
PDF_OCR_DPI=300

# === File type handling ===
# Comma-separated list of file types handled directly by docling-serve.
FILE_TYPES_STANDARD=docx,pptx,html,htm,xhtml,pdf,md,csv,xlsx,xml,json,vtt,jpg,jpeg,png,tif,tiff,bmp,webp
# Office-style file types that must be converted with soffice before docling.
FILE_TYPES_SOFFICE=.xls,.doc,.odf,.odp,.odt,.odg,.ods,.odm
# Toggle for converting the soffice list above; disable if soffice is unavailable.
ENABLE_SOFFICE_TYPES=1
# Extended MS Office file types requiring special conversion before docling (not yet implemented).
FILE_TYPES_MS_EXTENDED=.dotx,.docm,.dotm,.potx,.ppsx,.pptm,.potm,.ppsm,.xlsm
# Toggle for processing extended MS Office file types.
ENABLE_MS_EXTENDED_TYPES=0
# Audio/video file types (ingestion support not yet implemented).
FILE_TYPES_AUDIO=.wav,.mp3,.m4a,.aac,.ogg,.flac,.mp4,.avi,.mov
# Toggle for processing audio/video file types.
ENABLE_AUDIO_TYPES=0

# === Logging and debug controls (optional) ===
# Enable structured decision logging in SQLite database.
DECISION_LOG_ENABLED=1
# Maximum number of decision log entries per job.
DECISION_LOG_MAX_PER_JOB=50
# Enable verbose logging for troubleshooting (chunk planning, payloads, fallbacks).
DEBUG=0
# Directory where Brain request/response debug dumps are stored when DEBUG=1.
BRAIN_DEBUG_DIR=/opt/ct109-ingest/brain-debug

# === Scheduler and worker coordination (optional) ===
# Directory with source documents (default is Nextcloud documents folder).
NEXTCLOUD_DOC_DIR=/nextcloud/documents
# Directory for extracted images managed by docling.
NEXTCLOUD_IMAGE_DIR=/nextcloud/docling-images
# Base URL for the Nextcloud instance.
NEXTCLOUD_BASE_URL=http://192.168.177.133:8080
# User name for the Nextcloud connection.
NEXTCLOUD_USER=andreas
# API token for Nextcloud.
NEXTCLOUD_TOKEN=
# Comma-separated glob patterns to exclude from scanning.
EXCLUDE_GLOBS=
# Follow filesystem symlinks when scanning.
FOLLOW_SYMLINKS=0
# Maximum number of jobs enqueued per scan pass.
MAX_JOBS_PER_PASS=5
# Idle wait time (seconds) between scheduler scans.
SLEEP_SECS=10
# Time (seconds) to wait for the worker to stop when shutting down.
WORKER_STOP_TIMEOUT=20
# Location of the scheduler PID file (set by brain_scan.sh at runtime).
SCAN_SCHEDULER_PID_FILE=
# Lock timeout (seconds) before a job is considered stale.
LOCK_TIMEOUT_S=600
# Sleep interval (seconds) for the worker when idle.
IDLE_SLEEP_S=1.0
# Timeout (seconds) for worker HTTP calls to docling-serve.
DOCLING_SERVE_TIMEOUT=300
# Timeout (seconds) for docling-serve async jobs before giving up.
DOCLING_SERVE_ASYNC_TIMEOUT=900
# Poll interval (seconds) while waiting for async docling jobs to finish.
DOCLING_SERVE_ASYNC_POLL_INTERVAL=5
