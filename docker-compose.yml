services:
  rag-app:
    build: .
    container_name: rag-app
    ports:
      - "8000:8000"   # FastAPI
      - "8088:8088"   # Web GUI (existing web_gui.py)
      - "8081:8081"   # sqlite-web (state.db browser)
    volumes:
      # Development-friendly: live code edits without rebuild
      - ./:/app
      # Persist DB + logs + env
      - ./:/data
    environment:
      # variables/initENV.py respects ENV_FILE; keep runtime config in the persistent volume
      - ENV_FILE=/data/variables/.env.local
      - DB_PATH=/data/DocumentDatabase/state.db
      - SCHEDULER_LOG=/data/logs/scan_scheduler.log
      # Optional: keep defaults explicit (override in /data/variables/.env.local as needed)
      - WEB_GUI_HOST=0.0.0.0
      - WEB_GUI_PORT=8088
    restart: unless-stopped

volumes:
  rag_data:
